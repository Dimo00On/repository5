Сначала читаем строку, задающую язык, если в ней есть символы не из алфавита -  выдаём ошибку. Далее проверяем строку на обратную польскую запись: если в какой-то момент не хватает букв(или результатов от прошлых действий) для операций — выдаём ошибку. Если же в конце осталось больше, чем 1 результат от операций — выдаём ошибку. Иначе строка действительно в обратной польской записи. Далее считываем букву нужную букву, назовём её х, и длину подслова, которое хотим найти. Если длина меньше 0 — выдаём ошибку, если длина равна 0, то ответ точно ДА, так как в алфавите нет символа 0, значит задаваемый язык точно не пустой, значит там точно есть пустое слово как подстрока в каком-то слове из языка. Если длина больше 0 — проверяем, лежит ли буква в алфавите, если не лежит, выдаем ответ НЕТ, иначе запускаем алгоритм поиска максимального подслова из этой буквы. Будем идти по строке, задающей язык, и строить этот язык, и для каждой позиции хранить 4 числа: длину наибольшего префикса только из букв х в каком-то слове, лежащего в языке, полученного на этом этапе, длину наибольшего суффикса только из букв х в каком-то слове, длину наибольшего слова только из букв х, и длину максимального подслова только из букв х в каком-то слове. Тогда, если:
0) встретили букву х, тогда все 4 значения ставим 1.(очевидно)
1) встретили 1, тогда все 4 значения ставим 0.(очевидно)
2) встретили букву, но не 1 и не х, тогда длина префикса, суффикса и подстроки равна 0, а длину слова только из букв х установим на -1, так как его не только нет, но и вместе с другими языками при конкатенации оно испортит слово только из букв х, в то время как 1 при конкатенации ничего не портит.
1 . xxx →xxx, не испортили
a . xxx → axxx, больше слов только из букв х нет, испортили
3) встретили операцию *, тогда если в текущем языке было слово только из букв х хотя бы длины 1, то теперь можем получить слово из любого количества букв х, поэтому ставим все 4 значения +бесконечность. Если в текущем языке не было слов только из х длины хотя бы 1, то значения префикса, суффикса не изменятся, значение только слов из х останется(или станет, если до этого оно было -1) равным 1, так как пустое слово появится в языке, а значение подслова — это максимум из того, что было, и значений суффикса+префикса, так как могли взять слово с наибольшим суффиксом из х, и приписать в конце к нему слово с наибольшим префиксом из х:
axxxb* - подслово не изменится
(bx + xc)* - появится слово bxxc, подслово изменилось.
4) встретили операцию +, тогда берём максимум для каждого из 4 значений из соответствующих значений языков, которые складываем, так как в новом языке можем взять любое слово из языков, которые складываем
5) встретили операцию . (конкатенацию), тогда если в первом языке нет слов только из букв х, то префикс в новом языке — это префикс первого языка, иначе это максимум из префикса первого языка, и суммы (слово только из букв х первого языка + префикс второго языка), так как можем взять слово из первого языка только из букв х, приписать к нему слово с наибольшим префиксом из второго языка, и у этого слова префикс будет только из букв х:
(x + xxxb) . xc → тут максимум xxxbxc
(xx + xb) . xc → тут максимум xxxc
(случай конкатенации слов только из букв х из первого и второго языка учтен, так как слово только из букв х во втором языке учтено в словах с префиксом только из букв х во втором языке)
Пересчёт максимального суффикса аналогичен, только меняем первый и второй язык местами. 
Пересчёт максимального слова только из букв х: если хотя бы в 1 из языков нет слова только из букв х(то есть одно из значений -1), то и в новом языке таких слов не будет, ставим -1. Иначе это просто сумма значений в первом и втором языках:
(x + b) . (a + xx) → xxx, так как в обоих языках есть слова только из букв х
(a + b) . (x + xx + x*) → -1, нет слов только из х, так как любое слово начинается либо на а, либо на b.
Пересчёт максимального подслова: это максимум из уже имеющихся значений для первого и второго языка(так как приписывание к ним других слов слева или справа не уменьшит длину подслова из букв х), а также значения (суффикс первого + префикс второго)(очевидно случаи приписывания слов только из букв х из первого или второго слова учтены в суффиксе первого и префиксе второго)
bxxxa . cxxb → bxxxacxxb, ответ 3, из первого языка
cxxb . bxxxa → cxxbbxxxa, ответ 3 из второго языка
axx . xb → axxxb, ответ 3 как сумма суффикса первого языка и префикса второго языка

Таким образом мы найдём максимальную длину подстроки только из букв х в каком-то из слов итогового языка, значит, останется проверить, меньше ли это значение, чем требуемая длина, если меньше, то ответ НЕТ, иначе ответ ДА
